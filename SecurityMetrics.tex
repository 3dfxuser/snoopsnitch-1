\documentclass[a4paper,11pt,notitlepage,bigheadings,oneside]{scrartcl}
\input{srlabs}
\usepackage{mathtools}

\begin{document}

\newcommand{\TBD}{{\color{srldark}\textbf{TBD}}}
\newcommand{\FIXME}[1]{{\color{srldark}\textit{FIXME: #1}\par}}

\maketitle
\pagebreak

\tableofcontents
\pagebreak

\section{Introduction}
\label{sec:introduction}

\section{Background}
\label{sec:background}

% explain GSM/3G connection setup
% (formal) syntax and semantics of traces
% which protocol layer are we considering?

% Explain IMSI catchers (Type x)
% Abbreviate messages
% Explain expressions - ranging from 0 - 1

\section{2G Security Metric}
\label{sec:2g_security_metric}

\section{3G Security Metric}
\label{sec:3g_security_metric}

\section{IMSI Catcher Detection Metric}
\label{sec:imsi_catcher_detection_metric}

\subsection{Setup}

\subsubsection{[S1] Encryption Downgrade}

After using an encryption algorithm with a cell previously, encryption got
downgraded to a weaker algorithm.

\paragraph{Rationale}

Encryption may be disabled completely (A5/0) or limited to a deliberately
weakened algorithm (A5/2) due to legal restrictions in some countries.
Furthermore, an operator may not yet have the technical capabilities to use the
more secure A5/3 algorithm in all of his cells in favor of the broken A5/1 one.

If a weaker encryption algorithm is observed for the same cell at a later time,
this may be an indication for an attacker forcing the MS into an encryption
mode that she can attack (more easily). The most likely situation for an active
IMSI catcher is a downgrade to A5/0, i.e. null encryption. A downgrade from
A5/3 to A5/1 is expected to be rare, as for an active attacker it is much
easier to disable encryption all together instead of cracking A5/1.

This metric is relevant and applicable only when an existing cell id is reused
for an IMSI catcher. This is not very common, though, as IMSI catchers usually
create a new cell with different LAC to force the MS into a location update.
However, if an encryption downgrade happens, this is a very strong sign for an
attack.

\paragraph{False Positives}

An operator may mis-configure some of its base stations to use a weaker
encryption algorithm. In rare cases A5/0 transaction are observed, most likely
caused by hardware faults.

\FIXME{May A5/0 transactions be caused by mobiles not supporting / refusing to
perform encryption?}

\paragraph{Required Information}

A record of the strongest encryption algorithm that was observed for a given
cell ($a_{best}$). The CIPHER MODE COMMAND to extract the encryption algorithm
currently in use ($a_{curr}$).

\paragraph{Expression}

$s_1 =
\begin{cases}
	1 & \text{if } s(a_{curr}) < s(a_{best}) \\
	0 & \text{otherwise}
\end{cases}$

where $s(a)$ -- the strength of the encryption algorithm $a$ -- is defined as

$s(A5/0) < s(A5/2) < s(A5/1) < s(A5/3)$.

\paragraph{Score}

\TBD{} (Red)

\subsubsection{[S2] Delayed CIPHER MODE COMPLETE acknowledgement}

CIPHER MODE COMPLETE messages may be acknowledged by an IMSI Catcher with
significant delay.

\paragraph{Rationale}

When an active IMSI catcher mounts an attack against the A5/1 algorithm it
takes a significant amount of time to break the encryption (up to a couple of
seconds). During this period, the CIPHER MODE COMPLETE message is retransmitted
by the MS until an acknowledgment is received, assuming a previous message has
not reached the BTS. Both can be detected, the increase delay and a higher
retransmission count.

\paragraph{False Positives}

Lost CIPHER MODE COMPLETE packets due to bad network reception.

\paragraph{Required Information}

Time stamp of the first CIPHER MODE COMPLETE message ($t_{CIPH\_MOD\_COM_0}$).
Time stamp of the first encrypted message ($t_{enc\_msg_0}$).

\paragraph{Expression}

$s_2 = p(t_{enc\_msg_0} - t_{CIPH\_MOD\_COM_0})$

where $p(t)$ is the likelihood of the delay $t$ to be abnormal behaviour.

\paragraph{Score}

\TBD{} Graph the delays between CIPHER MODE COMPLETE and first encrypted
message based on GSMmap data over all data sets. Approximate a formula of that
empiric data and invert and scale it such that abnormally long and abnormally
short delays yield to a score of 1. The resulting formula is $p(t)$.

\subsubsection{[S3] CIPHER MODE COMMAND message without IMEISV}

In the CIPHER MODE COMMAND message from the network no IMEISV was requested.

\paragraph{Rationale}

The absence of an IMEISV makes the CIPHER MODE COMPLETE message -- the response
to the CIPHER MODE COMMAND message -- fully predictable. This enables an IMSI
catcher to mount a known-plaintext attack against the crypto algorithm.
Consequently, IMSI catchers may direct the MS to omit the IMSISV in its
response.

\paragraph{False Positives}

Not requesting the IMEISV is normal behaviour in some networks, as the IMEI may
be retrieved through a subsequent IDENTITY REQUEST at any later time.

\paragraph{Required Information}

The value of the "cipher response" field of the CIPHER MODE COMPLETE message.

\paragraph{Expression}

$s_3 =
\begin{cases}
	0 		& \text{if the IMEISV was requested} \\
	1 - p_{IMEISV}	& \text{otherwise}
\end{cases}$

where $p_{IMEISV}$ is the likelihood that operators request the IMEISV in their
normal CIPHER MODE COMPLETE messages.

\TBD{} From the GSMmap sample set, calculate the likelihood $p_{IMEISV}$ that
the IMEISV will be requested during normal operation.

\paragraph{Score}

\TBD{} (Yellow)

\subsubsection{[S4] No neighboring cells}

The serving cell is not advertising any neighbor cells.

\paragraph{Rationale}

Active IMSI catchers which record voice and data will try to prevent an MS from
transitioning back to a regular cell. For that reason an IMSI catcher might
announce no neighboring cells such that the MS will use the cell spawned by the
IMSI catcher until its signal level is too low.

Note, that less suspicious options exist for an IMSI catcher to solve that
problem. It could announce a normal amount of neighboring cells, but choose
ARFCN not used by any BTS in that area.

\paragraph{False Positives}

Only few regular situations, like small islands with only a single call, are
thinkable where no neighboring cells may be announced.

\TBD{} As part of the validation, search for cells announcing 0 neighboring
cells an check their location.

\paragraph{Required Information}

Neighboring cell list for the serving cell.

\paragraph{Expression}

$s4 = 1 - p(N)$,

where $p(n)$ is the likelihood of a cell to announce $n$ neighboring cells.
This formula is approximated from the GSMmap sample set. $N$ is the number of
neighboring cells announced by the serving cell.

\paragraph{Score}

\TBD{} (Yellow)

\subsubsection{[S5] High cell reselect offset}

The cell reselection offset is high.

\paragraph{Rationale}

The goal of announcing a large CELL RESELECT OFFSET is similar to S4. The CELL
RESELECT OFFSET is used to calculate the reselection criterion C2. Together
with the path loss criterion parameter C1 it is "used to ensure that the MS is
camped on the cell with which it has the highest probability of successful
communication on uplink and downlink." \cite[6.4]{gsm0508}

In cases where an IMSI catcher e.g. announces real, available neighboring
cells, it might choose to announce a CELL RESELECTION OFFSET that would require
the signal quality of any neighboring cell to be impossibly good to consider it
as an alternative to the cell spawned by the IMSI catcher.

% Explanation by Andreas Eversberg on Thu Jan 26 17:28:30 CET 2012
% (CatcherCatcher mailing list):
%
% - a catcher uses a high CRO (cell reselection offset). an offset up to
% 126 db makes a neighbour cell (catcher) +126 db "better" than the actual
% receive level from the catcher. a better cell is then selected by the
% phone, because "rx(cather)+CRO > rx(regual cell)+CRH". (CRH is used when
% changing location areas. it is generally set to 6db.)

\paragraph{False Positives}

Networks may announce a high CELL RESELECTION OFFSET in areas with poor
coverage.

\FIXME{Check what exactly is done with C1/C2/CELL RESELECTION OFFSET/TEMPORARY OFFSET}

\paragraph{Required Information}

Cell reselection parameter for the serving cell from BCCH (SI4).

\paragraph{Expression}

$s5 = p(C2)$

where $p(x)$ is a function expressing the likelihood for the $C2$ value of the
current cell to be abnormal.

\TBD{} Derive the function $p(x)$ from the distribution of all C2 values
calculated from the cell reselection parameters in the GSMmap sample set, such
that C2 values found in real networks get a low score (0) and abnormal values
get a high score (1).

\paragraph{Score}

\TBD{} (\textgreater 80dB - Yellow)

\subsection{Location update}

\subsubsection{[L1] Different cell ID for the same ARFCN}

The cell ID recently seen on an ARFCN suddenly changed.

\paragraph{Rationale}

An IMSI catcher may use the ARFCN of an existing BTS which has a weak signal in
the area the catcher operates. To force the MS into a location update, a LAC
different from all neighboring stations is chosen by the IMSI catcher.

The change of the LAC on a given ARFCN can be detected. Note, that for resource
efficiency, GSM reuses ARFCN in different geographic areas very frequently.
Hence, changes of the cell ID for a given ARFCN are specific to the geographic
location of the cell.

As associating an ARFCN/cell id combination with a precise location reliably
can be challenging, a simpler approach should be taken. The ARFCN and cell ID
is recorded together with a time stamp. If the same ARFCN is used with a
different cell ID within a certain time frame, this is considered an attack.

\paragraph{False Positives}

Multiple BTS operating on the same ARFCN may be receivable in the same
locations, e.g. in elevated places. Furthermore, an operator may reconfigure
the cell to use a different cell ID.

\paragraph{Required Information}

The ARFCN ($ARFCN_{curr}$) and CID ($CID_{curr}$) of the serving cell.

\paragraph{Expression}

$l_1 =
\begin{cases}
	0 & \text{if } cid(ARFCN_{curr}) = \varnothing \vee cid(ARFCN_{curr}) = CID_{curr} \\
	1 & \text{otherwise} \\
\end{cases}$

where $cid$ is a database that maps the ARFCNs used during the last $\Delta$
seconds to their respective CID.

\FIXME{$\Delta$ has to be chosen small enough so that it is unlikely to
encounter the same ARFCN twice when the MS is moving quickly. This could be
approximated by the average distance of cells with the same ARFCN and the
maximum travel speed supported by GSM.}

\FIXME{In theory we could also monitor neighboring cells in the same way.
Coming up with a decent $\Delta$ seems to be even more challenging as you
observe neighboring cells for a much longer time, potentially. Also, we cannot
get the respective AFCAN/CID combinations for neighboring cells right now on
Qualcomm (more precisely, we cannot correlate them from the data we get).}

\paragraph{Score}

\TBD{} (\textgreater 0 - Yellow, \textgreater 1 - Red)

\subsubsection{[L2] Inconsistent LAC}

The LAC of the current base station differs from the LAC of all neighboring cells.

\FIXME{For an IMSI catcher announcing no or non-existing neighboring cells,
this makes no sense. If the catcher announces, but prevents transition to them
e.g. by sending suitable cell reselection parameters, most of those real cells
likely have a different LAC. Trouble is, that neighbor list just consist of
ARFCN and the LAC needs to be read from the respective BCCHs. Unfortunately on
Qualcomm we cannot correlate the cell ID data with the ARFCN it was received
from an thus may not be able to obtain this information. Should we find a way,
it might be worthwhile to empirically derive a function $p(N)$ that estimates
the likelihood that $N$ of a cells neighboring stations have a different LAC.}

\paragraph{Rationale}

A MS will only perform a location update when changing to a different area,
i.e. a BTS with a different LAC. An IMSI needs to force a location update to be
able to interact with the phone. Therefore it must span a cell with a LAC
different to all surrounding cells and with a much better signal strength. If
the IMSI catcher announces realistic neighboring cells, this difference between
the LAC of the serving cell and all neighboring cell could be detected.

\paragraph{False Positives}

\TBD{}

\paragraph{Required Information}

Neighboring cell list ($NCL$). The LAC of the service cell ($LAC_{sc}$). The
LACs of the neighboring cells ($LACNC_i$).

\paragraph{Expression}

$l_2 = ?$

\TBD{}

\paragraph{Score}

\TBD{} (Yellow)

\subsubsection{[L3] ID requests during location update}

The network queries identity information (like IMSI and IMEI) after a LOCATION
UPDATE REQUEST and then rejects that request.

\paragraph{Rationale}

This is a fingerprint of a type 1 IMSI catcher, which ends the transaction as
soon as the identity of the MS has been recorded. In a sound network setup, one
can assume that an identity request only happens when encryption is in place,
i.e. after a CIPHER MODE COMPLETE.

\paragraph{False Positives}

\FIXME{A LOCATION UPDATE REJECT may happen when an MS is not accepted for
roaming, when it is stolen or the contract expired. However, more research is
necessary on the exact message patterns in this case.}

\paragraph{Required Information}

The sequence of messages between LOCATION UPDATE REQUEST and LOCATION UPDATE
REJECT (purged from idle messages). The type of LOCATION UPDATE REQUEST
(attach, periodic or normal) and the cause of the LOCATION UPDATE REJECT.

\paragraph{Expression}

$l_3 = ?$

\FIXME{This needs more research. A first step could be to filter all
transactions resulting in a LOCATION UPDATE REJECT and containing an IDENTITY
REQUEST prior to the CIPHER MODE COMPLETE message. In the resulting set,
correlate type of the LOCATION UPDATE REQUEST (Attach, Periodic, Normal) with
the cause of the LOCATION UPDATE REJECT and the identity information requested
(IMEI, IMSI, both).}

\paragraph{Score}

\TBD{} (Yellow)

\subsubsection{[L4] Low registration timer}

The initial value of the registration timer T3212 is low.

\paragraph{Rationale}

The registration timer T3212 controls the interval a MS performs a periodic
LOCATION UPDATE, i.e. one that is performed regularly when the location area of
the MS does not change. The T3212 of an MS is initialized from the time-out
value in the \emph{Control Channel Description} which is broadcast as part of
SI3 on the service cells BCCH. It can be set at a granularity of decihours
(6~minutes) and supports a maximum value of 25.5 hours (255~decihours). The
value of 0 disables periodic location updates completely.

An IMSI catcher might broadcast an initialization value for the registration
timer that causes the phone to updates its location with the catcher very
often, e.g. every 6 minutes. This allows for rather precise presence tracking.

\paragraph{False Positives}

None known.

\paragraph{Required Information}

Time-out initialization value for T3212 ($T3212_0$) from the \emph{Control
Channel Description} part of the serving cells SI3.

\paragraph{Expression}

$l4 =
\begin{cases}
	0 	 	& \text{if } T3212_0 = 0 \\
	p(T3212_0) 	& \text{otherwise}
\end{cases}$

where $p(x)$ is derived from the distribution of $T3212$ initialization values
observed in the GSMmap sample set. \FIXME{We do not have this information in
the current data, we need to check the xgoldmon traces or create new traces
using Qualcomm}

\paragraph{Score}

\TBD{} (\textless 10 minutes - Yellow)

\subsection{Tracking}

\subsubsection{[T1] Paging without transaction}

The MS is paged without entering a transaction.

\paragraph{Rationale}

\TBD{}

\paragraph{False Positives}

\TBD{}

\paragraph{Required Information}

\TBD{}

\paragraph{Expression}

\TBD{}

\paragraph{Score}

\TBD{} (Red)

\subsubsection{[T2] Orphaned traffic channel}

A traffic channel is assigned, but no call control state is entered or test
message received.

\paragraph{Rationale}

\TBD{}

\paragraph{False Positives}

\TBD{}

\paragraph{Required Information}

\TBD{}

\paragraph{Expression}

\TBD{}

\paragraph{Score}

\TBD{} (\textgreater 2s - Red, \textgreater 10s - Black)

\FIXME{Need to validate those times or even make dynamic calculation adding to overall score.}

\subsubsection{[T3] Missing call setup message}

No call setup message is received while already being on the traffic channel.

\paragraph{Rationale}

\TBD{}

\paragraph{False Positives}

\TBD{}

\paragraph{Required Information}

\TBD{}

\paragraph{Expression}

\TBD{}

\paragraph{Score}

\TBD{} (\textgreater 2s - Red, \textgreater 10s - Black)

\FIXME{Need to validate those times or even make dynamic calculation adding to overall score.}

\subsubsection{[T4] MS sends on high power}

The MS sends on high power.

\paragraph{Rationale}

\TBD{}

\paragraph{False Positives}

\TBD{}

\paragraph{Required Information}

\TBD{}

\paragraph{Expression}

\TBD{}

\paragraph{Score}

\TBD{} (Highest TX power - Yellow)

%%%%%%%
%%%%%%%

\subsection{Other (TODO: Check)}

Ideas labeled with id \emph{Xi} taken from "Marcus Prem, Diplomarbeit: Erkennen
und Abwehren von Angriffen im Mobilfunknetz auf Smartphones, Wilhelm Büchner
Hochschule Darmstadt Fachbereich Informatik". We should check them for
plausibility, relevance and feasibility.

Ideas labeled with id \emph{Yi} taken from "XCell Dynamic IMEI v2 User Manual",
xcell technologies.

Ideas labeled with id \emph{Zi} are own thoughts.

\subsubsection{[X1] Forced Connection}

Detect if BTS with weakest signal is imitated or a  raise of signal strength
(RSS) of this BTS is measured (FB02).

\subsubsection{[X2] Inconsistent neighbor tables}

Neighboring cell information of \emph{neighboring stations} should be
consistent with current BTS, i.e it should be listed as strongest neighboring
BTS (FB03).

A strategy of an IMSI catcher to prevent an MS that was already connected to
register again, is to send a BA list over the BCCH that contains only
neighboring cells which do \emph{not} have the ARFCN of the IMSI catcher in
their own BA list \cite[0027]{bott2000verfahren}. When the MS selects one of
those neighboring cells, it will not consider the IMSI catcher at least for the
next cell reselection.

\FIXME{"The MS shall attempt to decode the BCCH data block that contains the
parameters affecting cell reselection for each of the 6 strongest non-serving
cell BCCH carriers at least every 5 minutes." \cite[section 6.6.1]{gsm0508}
Theoretically, we should have the neighboring information of these 6
non-serving cells available for correlation with our current neighboring
cells.}

\subsubsection{[X3] Rejection by IMSI catcher}

No uplink is possible via PRACH (FB04). \FIXME{What does Prem mean with "mind
Aloah"?}

\subsubsection{[X4] Signal run time difference}

Send a "Hello packet-delay" to the BTS and try to detect duplicate and delayed
answers (FB05).

\subsubsection{[X5] E-OTD localization (???)}

Test the network using localization services (LBS), e.g. a non-responding BTS
or multiple, overlapping answers (FB06).

\subsubsection{[Y1] Many network re-registration requests}

An abnormal number of re-registration requests is received from the GSM
network.

\subsubsection{[Z1] No UMTS/LTE available}

As IMSI catchers often are GSM only, they rely on jamming other technologies
like UMTS and LTE. Having only GSM available should add to the overall score.

\subsubsection{[Z2] Low downlink signaling counter}

The downlink signaling counter (DSC) is a failure criterion the MS maintains
for the paging channel (PCH). The DSC is initialized to
$Round(90/\text{BS\_PA\_MFRMS})$, where BS\_PA\_MFRMS is a parameter broadcast
on the BCCH. Whenever the MS successfully decodes a message in its paging
subchannel, DSC is increased by 1, otherwise DSC is decreased by 4. As soon as
DSC reaches 0, a downlink failure is declared which results in the selection of
a different cell.

As outlined in \cite{bott2000verfahren}, this behavior may be used by IMSI
catchers to force the MS to connect to the real network again, after the IMSI
catcher has collected the desired information. In order to do this, the IMSI
catcher sends invalid data on the PCH until the DSC has reached 0.

\subsubsection{[Z3] Maximum number of paging groups}

When an IMSI catcher uses the technique described in
\cite[0021]{bott2000verfahren} to force the MS back into a regular network,
invalid data is send on the PCH of the respective paging group of that MS until
the MS performs a cell reselection. This has the side effect that any other MS
on the same paging group also selects a different cell. Hence, the cell spawned
by an IMSI catcher using this technique will try to maximize the number of
paging groups ($N$) in that cell to increase the granularity at which MSes can
be disconnected.

${N} = (9 - {\text{BS\_AG\_BLKS\_RES}} - 6\times {\text{BS\_CCCH\_SDCCH\_COMB}})\times {\text{BS\_PA\_MFRS}}$

\FIXME{Analyze GSMmap data for abnormally high $N$}

\subsubsection{[Z4] Reject with "location area not allowed"}

A MS performs a cell reselection when a LOCATION UPDATE REQUEST has been
rejected with a "location area not allowed". This may be used by an IMSI
catcher to force the MS so select a different cell after information was
collected.

\FIXME{Are there other LOCATION UPDATE REJECT causes that force a cell
reselection?}

\subsection{Weighting}

\section{Detection of Privacy Breaches}
\label{sec:detection_of_privacy_breaches}

\subsubsection{[P1] Silent text message received}

Silent text messages have been received.

\paragraph{Rationale}

\TBD{}

\paragraph{False Positives}

\FIXME{Any other good (i.e. non surveillance) reasons for silent SMS messages?}

\paragraph{Required Information}

\TBD{}

\paragraph{Expression}

\TBD{}

\paragraph{Score}

\TBD{} (Yellow)

\section{Model Validation}

\appendix
\section{Document History}
\label{sec:document_history}

\begin{tabular*}{\textwidth}{@{\extracolsep{\fill}} l l l l}
\toprule
{\bf Version} 	& {\bf Date} 		& {\bf Editor} 		& {\bf Changes} \\
\midrule
0.2		& August 6th, 2014 	& Alexander Senier 	& Extend IMSI catcher criteria \\
\bottomrule
\end{tabular*}


\bibliographystyle{plain}
\bibliography{bibliography}

\end{document}
